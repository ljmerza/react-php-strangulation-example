const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Card-DYfC9pIH.js","assets/registerReactComponent-WbUqackn.js","assets/index-8FW48s7X.js","assets/Child-Mfpy6Qir.js","assets/DataTable-BRE1Wqwc.js","assets/FormComposer-DlhkXZUF.js","assets/FormField-UxbBRLTB.js","assets/Hello-cPe77Bd4.js","assets/PHPComposableCard-D0j_fb6l.js","assets/Parent-0kieMew3.js"])))=>i.map(i=>d[i]);
import{r as C}from"./assets/registerReactComponent-WbUqackn.js";const w="modulepreload",b=function(d){return"/"+d},h={},l=function(e,o,s){let t=Promise.resolve();if(o&&o.length>0){let v=function(i){return Promise.all(i.map(m=>Promise.resolve(m).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),a=r?.nonce||r?.getAttribute("nonce");t=v(o.map(i=>{if(i=b(i),i in h)return;h[i]=!0;const m=i.endsWith(".css"),p=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${p}`))return;const c=document.createElement("link");if(c.rel=m?"stylesheet":w,m||(c.as="script"),c.crossOrigin="",c.href=i,a&&c.setAttribute("nonce",a),document.head.appendChild(c),m)return new Promise((y,g)=>{c.addEventListener("load",y),c.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${i}`)))})}))}function n(r){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=r,window.dispatchEvent(a),!a.defaultPrevented)throw r}return t.then(r=>{for(const a of r||[])a.status==="rejected"&&n(a.reason);return e().catch(n)})};class E{constructor(){this.components=new Map,this.loadedComponents=new Set,this.observers=[],this.manifest=null}async loadManifest(){if(!this.manifest)try{const e=await fetch("./components.manifest.json");this.manifest=await e.json(),this.notifyObservers("manifest-loaded",this.manifest)}catch(e){console.warn("Could not load component manifest:",e),this.manifest={components:{}}}return this.manifest}register(e,o,s={}){return this.components.set(e,{loader:o,metadata:{loaded:!1,registeredAt:Date.now(),...s}}),this.notifyObservers("component-registered",e),this}async discoverFromManifest(){const e=await this.loadManifest(),o=[];for(const[s,t]of Object.entries(e.components))if(!this.components.has(s)){const n=()=>import(t.path);this.register(s,n,{version:t.version,description:t.description,props:t.props,source:"manifest"}),o.push(s)}return this.notifyObservers("discovery-completed",{source:"manifest",discovered:o}),o}async discoverFromFiles(){const e=Object.assign({"./components/Card.jsx":()=>l(()=>import("./assets/Card-DYfC9pIH.js"),__vite__mapDeps([0,1,2])),"./components/Child.jsx":()=>l(()=>import("./assets/Child-Mfpy6Qir.js"),__vite__mapDeps([3,1,2])),"./components/DataTable.jsx":()=>l(()=>import("./assets/DataTable-BRE1Wqwc.js"),__vite__mapDeps([4,1,2])),"./components/FormComposer.jsx":()=>l(()=>import("./assets/FormComposer-DlhkXZUF.js"),__vite__mapDeps([5,1,2,6])),"./components/FormField.jsx":()=>l(()=>import("./assets/FormField-UxbBRLTB.js"),__vite__mapDeps([6,1,2])),"./components/Hello.jsx":()=>l(()=>import("./assets/Hello-cPe77Bd4.js"),__vite__mapDeps([7,1,2])),"./components/PHPComposableCard.jsx":()=>l(()=>import("./assets/PHPComposableCard-D0j_fb6l.js"),__vite__mapDeps([8,1,2])),"./components/Parent.jsx":()=>l(()=>import("./assets/Parent-0kieMew3.js"),__vite__mapDeps([9,1,2,3]))}),o=[];for(const[s,t]of Object.entries(e)){const n=s.match(/\/([^/]+)\.jsx$/)?.[1];if(n){const r=`${n.toLowerCase()}-widget`;this.components.has(r)||(this.register(r,t,{path:s,source:"filesystem",autoDiscovered:!0}),o.push(r))}}return this.notifyObservers("discovery-completed",{source:"filesystem",discovered:o}),o}discoverFromDOM(){const e=document.querySelectorAll("*"),o=new Set;e.forEach(t=>{const n=t.tagName.toLowerCase();n.includes("-")&&o.add(n)});const s=Array.from(o);return this.notifyObservers("discovery-completed",{source:"dom",discovered:s}),s}getAvailableComponents(){return Array.from(this.components.keys())}getComponentInfo(e){const o=this.components.get(e);return o?{tagName:e,loaded:this.loadedComponents.has(e),...o.metadata}:null}async load(e){const o=this.components.get(e);if(!o)throw new Error(`Component ${e} not found in registry`);if(!this.loadedComponents.has(e))try{this.notifyObservers("component-loading",e);const t=(await o.loader()).default;C(e,t),this.loadedComponents.add(e),o.metadata.loaded=!0,o.metadata.loadedAt=Date.now(),this.notifyObservers("component-loaded",e)}catch(s){throw this.notifyObservers("component-load-error",{tagName:e,error:s}),new Error(`Failed to load component ${e}: ${s.message}`)}}async loadMultiple(e){const o=await Promise.allSettled(e.map(n=>this.load(n))),s=[],t=[];return o.forEach((n,r)=>{n.status==="fulfilled"?s.push(e[r]):t.push({tagName:e[r],error:n.reason})}),{loaded:s,failed:t}}async loadAll(){const e=this.getAvailableComponents();return this.loadMultiple(e)}async autoLoad(){const o=this.discoverFromDOM().filter(s=>this.components.has(s)&&!this.loadedComponents.has(s));return o.length>0?this.loadMultiple(o):{loaded:[],failed:[]}}subscribe(e){return this.observers.push(e),()=>{const o=this.observers.indexOf(e);o>-1&&this.observers.splice(o,1)}}notifyObservers(e,o){this.observers.forEach(s=>{try{s({type:e,data:o,timestamp:Date.now()})}catch(t){console.error("Observer error:",t)}})}getStats(){const e=this.getAvailableComponents().map(o=>this.getComponentInfo(o));return{totalComponents:this.components.size,loadedComponents:this.loadedComponents.size,unloadedComponents:this.components.size-this.loadedComponents.size,components:e,performance:this.getPerformanceMetrics(e)}}getPerformanceMetrics(e){const o=e.filter(t=>t.loaded),s=e.filter(t=>!t.loaded);return{loadedComponents:o.map(t=>({name:t.tagName,loadTime:t.loadedAt-t.registeredAt,source:t.source})),unloadedComponents:s.map(t=>({name:t.tagName,savedBandwidth:!0,source:t.source})),totalLoadTime:o.reduce((t,n)=>t+(n.loadedAt-n.registeredAt),0),bandwidthSavings:s.length>0?`${s.length} components not loaded`:"All components loaded"}}}const _=new E;class D{constructor(){this.registry=_,this.initialized=!1}async init(){if(!this.initialized){this.registry.subscribe(e=>{console.log(`[ComponentDiscovery] ${e.type}:`,e.data)});try{console.log("[ComponentDiscovery] Loading manifest..."),await this.registry.discoverFromManifest(),console.log("[ComponentDiscovery] Discovering from filesystem..."),await this.registry.discoverFromFiles(),console.log("[ComponentDiscovery] Scanning DOM for components..."),this.registry.discoverFromDOM(),this.initialized=!0,console.log("[ComponentDiscovery] Initialization complete")}catch(e){console.error("[ComponentDiscovery] Initialization failed:",e)}}}async autoLoad(){await this.init();const e=await this.registry.autoLoad();return e.loaded.length>0&&console.log("[ComponentDiscovery] Auto-loaded components:",e.loaded),e.failed.length>0&&console.warn("[ComponentDiscovery] Failed to load components:",e.failed),e}async loadComponent(e){await this.init();try{return await this.registry.load(e),console.log(`[ComponentDiscovery] Loaded component: ${e}`),!0}catch(o){return console.error(`[ComponentDiscovery] Failed to load ${e}:`,o),!1}}async loadAll(){await this.init();const e=await this.registry.loadAll();return console.log("[ComponentDiscovery] Load all results:",e),e}getComponentInfo(e){return this.registry.getComponentInfo(e)}getStats(){return this.registry.getStats()}listAvailable(){return this.registry.getAvailableComponents()}}const u=new D;class O{constructor(e){this.discovery=e,this.observer=null,this.processingQueue=new Set}start(){this.observer||(this.observer=new MutationObserver(e=>{const o=new Set;e.forEach(s=>{s.addedNodes.forEach(t=>{t.nodeType===Node.ELEMENT_NODE&&(t.tagName&&t.tagName.includes("-")&&o.add(t.tagName.toLowerCase()),t.querySelectorAll?.('*[tagName*="-"], *[is]')?.forEach(r=>{r.tagName.includes("-")&&o.add(r.tagName.toLowerCase())}))})}),o.forEach(s=>{this.processingQueue.has(s)||(this.processingQueue.add(s),this.processComponent(s))})}),this.observer.observe(document.body,{childList:!0,subtree:!0}),console.log("[ComponentObserver] Started watching for new components"))}async processComponent(e){try{const o=this.discovery.getComponentInfo(e);o&&!o.loaded&&(console.log(`[ComponentObserver] Auto-loading detected component: ${e}`),await this.discovery.loadComponent(e))}catch(o){console.warn(`[ComponentObserver] Could not auto-load ${e}:`,o)}finally{this.processingQueue.delete(e)}}stop(){this.observer&&(this.observer.disconnect(),this.observer=null,console.log("[ComponentObserver] Stopped watching"))}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>f()):f();async function f(){console.log("[ComponentDiscovery] Starting auto-discovery..."),await u.init(),await u.autoLoad(),new O(u).start(),window.componentDiscovery=u,console.log("[ComponentDiscovery] System ready. Available commands:"),console.log("- window.componentDiscovery.listAvailable()"),console.log("- window.componentDiscovery.getStats()"),console.log("- window.componentDiscovery.loadComponent(tagName)")}
