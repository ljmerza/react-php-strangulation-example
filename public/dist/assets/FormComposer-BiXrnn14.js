import{j as t}from"../discover.js";import{r as m}from"./index-BtKkNgeU.js";import E from"./FormField-DzpWSSAm.js";function w({title:h="Form",fields:i=[],initialData:c={},onSubmit:g,onFieldChange:y,submitLabel:u="Submit",resetLabel:j="Reset",children:a=""}){const[n,l]=m.useState(c),[p,d]=m.useState({}),b=m.useMemo(()=>{if(!a||i.length>0)return i;const s=new DOMParser().parseFromString(`<div>${a}</div>`,"text/html").querySelectorAll("form-field");return Array.from(s).map(o=>{const x={name:o.getAttribute("name")||"",label:o.getAttribute("label")||"",type:o.getAttribute("type")||"text",required:o.hasAttribute("required"),placeholder:o.getAttribute("placeholder")||""};return x.type==="select"&&(x.children=o.innerHTML),x})},[a,i]),f=m.useMemo(()=>{if(!a)return{label:u};const s=new DOMParser().parseFromString(`<div>${a}</div>`,"text/html").querySelector("form-submit");return s?{label:s.textContent||u,type:s.getAttribute("type")||"primary"}:{label:u}},[a,u]);m.useEffect(()=>{l(c)},[c]);const v=(r,e)=>{const s={...n,[r]:e};l(s),p[r]&&d(o=>({...o,[r]:null})),y?.(r,e,s)},F=()=>{const r={};return b.forEach(e=>{if(!(!e||!e.name)&&(e.required&&!n[e.name]&&(r[e.name]=`${e.label||e.name} is required`),e.validate&&n[e.name])){const s=e.validate(n[e.name],n);s!==!0&&(r[e.name]=s)}}),d(r),Object.keys(r).length===0},S=r=>{r.preventDefault(),F()&&g?.(n)},A=()=>{l(c),d({})};return t.jsxs("div",{className:"form-composer",children:[t.jsxs("form",{onSubmit:S,children:[h&&t.jsx("h3",{children:h}),t.jsx("div",{className:"form-fields",children:b.map((r,e)=>!r||!r.name?null:t.jsxs("div",{className:"field-wrapper",children:[t.jsx(E,{...r,value:n[r.name],onChange:v}),p[r.name]&&t.jsx("div",{className:"field-error",children:p[r.name]})]},r.name||e))}),t.jsxs("div",{className:"form-actions",children:[t.jsx("button",{type:"submit",className:`form-submit ${f.type||"primary"}`,children:f.label}),t.jsx("button",{type:"button",onClick:A,className:"form-reset",children:j})]})]}),t.jsxs("div",{className:"form-debug",style:{marginTop:"20px",fontSize:"12px",color:"#666"},children:[t.jsx("strong",{children:"Form Data:"})," ",JSON.stringify(n,null,2)]})]})}export{w as default};
